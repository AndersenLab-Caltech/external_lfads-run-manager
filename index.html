
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation of LFADS Run Manager for Matlab">
      
      
      
        <meta name="author" content="Daniel J. O'Shea">
      
      
        <link rel="shortcut icon" href="./assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>LFADS Run Manager</title>
      
    
    
      <script src="./assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      <link rel="stylesheet" href="./assets/stylesheets/application-a20f419c8e.css">
      
        <link rel="stylesheet" href="./assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="LFADS Run Manager" class="md-header-nav__button md-logo">
          
            <i class="md-icon md-icon--home"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Overview
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/djoshea/lfads-run-manager" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      djoshea/lfads-run-manager
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </div>
    LFADS Run Manager
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/djoshea/lfads-run-manager" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      djoshea/lfads-run-manager
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Overview
      </label>
    
    <a href="." title="Overview" class="md-nav__link md-nav__link--active">
      Overview
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-example" title="Quick example" class="md-nav__link">
    Quick example
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="matlab/" title="Matlab Classes and Packages" class="md-nav__link">
      Matlab Classes and Packages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="concepts/" title="Key Concepts" class="md-nav__link">
      Key Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="adapting/" title="Interfacing with your Datasets" class="md-nav__link">
      Interfacing with your Datasets
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="drive/" title="Preparing for LFADS" class="md-nav__link">
      Preparing for LFADS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="files/" title="File Organization" class="md-nav__link">
      File Organization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="multisession/" title="Multisession Stitched Models" class="md-nav__link">
      Multisession Stitched Models
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="running/" title="Running LFADS" class="md-nav__link">
      Running LFADS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="analysis/" title="Analyzing LFADS Posterior Means" class="md-nav__link">
      Analyzing LFADS Posterior Means
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="trained_params/" title="Loading the Model Trained Parameters" class="md-nav__link">
      Loading the Model Trained Parameters
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-example" title="Quick example" class="md-nav__link">
    Quick example
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="lfads-run-manager-for-matlab-documentation">LFADS Run Manager for Matlab Documentation<a class="headerlink" href="#lfads-run-manager-for-matlab-documentation" title="Permanent link">&para;</a></h1>
<p>LFADS Run Manager is a set of tools, written in Matlab, that help organize, train, and analyze LFADS models using the <a href="https://github.com/tensorflow/models/tree/master/research/lfads">Python+Tensorflow LFADS code</a>. LFADS, or Latent Factor Analysis via Dynamical Systems, is a deep learning method to infer latent dynamics from single-trial neural spiking data. LFADS uses a nonlinear dynamical system (a recurrent neural network) to infer the dynamics underlying observed population activity and to extract ‘de-noised’ single-trial firing rates from neural spiking data.</p>
<p>Read the <a href="https://www.biorxiv.org/content/early/2017/06/20/152884">LFADS pre-print</a> for more details.</p>
<p>LFADS Run Manager helps you to:</p>
<ul>
<li>Organize your spiking neural datasets that will be used to train LFADS models.</li>
<li>Setup a collection of training runs that vary in hyperparameter settings and the particular datasets included. The latter is particularly useful when generating <em>stitched</em> multisession LFADS models.</li>
<li>Generate shell scripts that will launch individual LFADS training runs <em>or</em> generate a script that will run the full set of runs somewhat in parallel by load balancing across GPUs and CPUs.</li>
<li>Load the posterior means and parameters of individual LFADS models after each has finished training.</li>
<li>Facilitate analysis, visualization, and comparison of the learned LFADS model generated factors, rates, etc.</li>
</ul>
<p>The code within the run manager helps organize LFADS runs and facilitate analysis, but ultimately calls the Python+Tensorflow LFADS code available on <a href="https://github.com/tensorflow/models/tree/master/research/lfads">Github</a>.</p>
<p>To use the run manager, you will need to author a few functions that perform specific data processing steps that are specific to your datasets, such as extracting spike times. The goal of the run manager is to facilitate the above common tasks in a fairly dataset agnostic way, sparing you the need to hand-generate many one-off scripts to export data to HD5 in the right locations, drive the Tensorflow training, and to load the results from disk.</p>
<h2 id="quick-example">Quick example<a class="headerlink" href="#quick-example" title="Permanent link">&para;</a></h2>
<p>We&rsquo;ll walkthrough this example in more detail in this documentation, but to give you an idea of how the run manager works, here&rsquo;s the Matlab code you&rsquo;d use to launch a couple of runs.</p>
<div class="codehilite"><pre><span></span><span class="c">% Identify the datasets you&#39;ll be using</span>
<span class="n">dc</span> <span class="p">=</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">DatasetCollection</span><span class="p">(</span><span class="s">&#39;~/lorenz_example/datasets&#39;</span><span class="p">);</span>
<span class="n">dc</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">&#39;lorenz_example&#39;</span><span class="p">;</span>
<span class="n">MyExperiment</span><span class="p">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="s">&#39;dataset001.mat&#39;</span><span class="p">);</span>
<span class="n">MyExperiment</span><span class="p">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="s">&#39;dataset002.mat&#39;</span><span class="p">);</span>
<span class="n">MyExperiment</span><span class="p">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="s">&#39;dataset003.mat&#39;</span><span class="p">);</span>
<span class="n">dc</span><span class="p">.</span><span class="n">loadInfo</span><span class="p">;</span>

<span class="c">% Run a single model for each dataset, and one stitched run with all datasets</span>
<span class="n">runRoot</span> <span class="p">=</span> <span class="s">&#39;~/lorenz_example/runs&#39;</span><span class="p">;</span>
<span class="n">rc</span> <span class="p">=</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunCollection</span><span class="p">(</span><span class="n">runRoot</span><span class="p">,</span> <span class="s">&#39;exampleRun&#39;</span><span class="p">,</span> <span class="n">dc</span><span class="p">);</span>

<span class="c">% Setup hyperparameters, 4 sets with number of factors swept through 2,4,6,8</span>
<span class="n">par</span> <span class="p">=</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span><span class="p">;</span>
<span class="n">par</span><span class="p">.</span><span class="n">spikeBinMs</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c">% rebin the data at 2 ms</span>
<span class="n">par</span><span class="p">.</span><span class="n">c_co_dim</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% no controller --&gt; no inputs to generator</span>
<span class="n">par</span><span class="p">.</span><span class="n">c_batch_size</span> <span class="p">=</span> <span class="mi">150</span><span class="p">;</span> <span class="c">% must be &lt; 1/5 of the min trial count</span>
<span class="n">par</span><span class="p">.</span><span class="n">useAlignmentMatrix</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span> <span class="c">% use alignment matrices initial guess for multisession stitching</span>
<span class="n">par</span><span class="p">.</span><span class="n">c_gen_dim</span> <span class="p">=</span> <span class="mi">64</span><span class="p">;</span> <span class="c">% number of units in generator RNN</span>
<span class="n">par</span><span class="p">.</span><span class="n">c_ic_enc_dim</span> <span class="p">=</span> <span class="mi">64</span><span class="p">;</span> <span class="c">% number of units in encoder RNN</span>
<span class="n">par</span><span class="p">.</span><span class="n">c_learning_rate_stop</span> <span class="p">=</span> <span class="mf">1e-3</span><span class="p">;</span> <span class="c">% we can stop really early for the demo</span>
<span class="n">parSet</span> <span class="p">=</span> <span class="n">par</span><span class="p">.</span><span class="n">generateSweep</span><span class="p">(</span><span class="s">&#39;c_factors_dim&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">8</span><span class="p">]);</span>
<span class="n">rc</span><span class="p">.</span><span class="n">addParams</span><span class="p">(</span><span class="n">parSet</span><span class="p">);</span>

<span class="c">% Setup which datasets are included in each run, 1 for each dataset individually</span>
<span class="k">for</span> <span class="n">iR</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">dc</span><span class="p">.</span><span class="n">nDatasets</span>
    <span class="n">rc</span><span class="p">.</span><span class="n">addRunSpec</span><span class="p">(</span><span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span><span class="p">(</span><span class="n">dc</span><span class="p">.</span><span class="n">datasets</span><span class="p">(</span><span class="n">iR</span><span class="p">).</span><span class="n">getSingleRunName</span><span class="p">(),</span> <span class="n">dc</span><span class="p">,</span> <span class="n">iR</span><span class="p">));</span>
<span class="k">end</span>
<span class="c">% and the final stitching run with all datasets</span>
<span class="n">rc</span><span class="p">.</span><span class="n">addRunSpec</span><span class="p">(</span><span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dc</span><span class="p">.</span><span class="n">nDatasets</span><span class="p">));</span>

<span class="c">% Generate files needed for LFADS input on disk</span>
<span class="n">rc</span><span class="p">.</span><span class="n">prepareForLFADS</span><span class="p">();</span>

<span class="c">% Write a python script that will train all of the LFADS runs using a</span>
<span class="c">% load-balancer against the available CPUs and GPUs</span>
<span class="n">rc</span><span class="p">.</span><span class="n">writeShellScriptRunQueue</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s">&#39;maxTasksSimultaneously&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;gpuList&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39;virtualenv&#39;</span><span class="p">,</span> <span class="s">&#39;tensorflow&#39;</span><span class="p">);</span>
</pre></div>

<p>You&rsquo;ve now setup a 4 x 4 grid of LFADS runs, spanning 4 different hyperparameter settings and 4 different dataset subsets (3 with one dataset, 1 stitching together all datasets).</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">rc</span>

<span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunCollection</span> &quot;<span class="n">exampleRun</span>&quot; <span class="p">(</span><span class="mi">16</span> <span class="n">runs</span> <span class="n">total</span><span class="p">)</span>
  <span class="n">Dataset</span> <span class="n">Collection</span> &quot;<span class="n">lorenz_example</span>&quot; <span class="p">(</span><span class="mi">3</span> <span class="n">datasets</span><span class="p">)</span> <span class="n">in</span> <span class="o">~/</span><span class="n">lorenz_example</span><span class="o">/</span><span class="n">datasets</span>
  <span class="n">Path</span><span class="p">:</span> <span class="o">~/</span><span class="n">lorenz_example</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">exampleRun</span>

  <span class="mi">4</span> <span class="n">parameter</span> <span class="n">settings</span>
  <span class="p">[</span><span class="mi">1</span> <span class="n">param_7I6XSW</span> <span class="n">data_</span><span class="o">-</span><span class="n">MSPr6</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span> <span class="n">useAlignmentMatrix</span><span class="p">=</span><span class="n">true</span> <span class="n">c_factors_dim</span><span class="p">=</span><span class="mi">2</span> <span class="n">c_ic_enc_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_gen_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_co_dim</span><span class="p">=</span><span class="mi">0</span> <span class="n">c_batch_size</span><span class="p">=</span><span class="mi">150</span> <span class="n">c_learning_rate_stop</span><span class="p">=</span><span class="mf">0.001</span>
  <span class="p">[</span><span class="mi">2</span> <span class="n">param_O4V73g</span> <span class="n">data_</span><span class="o">-</span><span class="n">MSPr6</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span> <span class="n">useAlignmentMatrix</span><span class="p">=</span><span class="n">true</span> <span class="n">c_factors_dim</span><span class="p">=</span><span class="mi">4</span> <span class="n">c_ic_enc_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_gen_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_co_dim</span><span class="p">=</span><span class="mi">0</span> <span class="n">c_batch_size</span><span class="p">=</span><span class="mi">150</span> <span class="n">c_learning_rate_stop</span><span class="p">=</span><span class="mf">0.001</span>
  <span class="p">[</span><span class="mi">3</span> <span class="n">param_ngqEhM</span> <span class="n">data_</span><span class="o">-</span><span class="n">MSPr6</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span> <span class="n">useAlignmentMatrix</span><span class="p">=</span><span class="n">true</span> <span class="n">c_factors_dim</span><span class="p">=</span><span class="mi">6</span> <span class="n">c_ic_enc_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_gen_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_co_dim</span><span class="p">=</span><span class="mi">0</span> <span class="n">c_batch_size</span><span class="p">=</span><span class="mi">150</span> <span class="n">c_learning_rate_stop</span><span class="p">=</span><span class="mf">0.001</span>
  <span class="p">[</span><span class="mi">4</span> <span class="n">param_Qr2PeG</span> <span class="n">data_</span><span class="o">-</span><span class="n">MSPr6</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span> <span class="n">useAlignmentMatrix</span><span class="p">=</span><span class="n">true</span> <span class="n">c_factors_dim</span><span class="p">=</span><span class="mi">8</span> <span class="n">c_ic_enc_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_gen_dim</span><span class="p">=</span><span class="mi">64</span> <span class="n">c_co_dim</span><span class="p">=</span><span class="mi">0</span> <span class="n">c_batch_size</span><span class="p">=</span><span class="mi">150</span> <span class="n">c_learning_rate_stop</span><span class="p">=</span><span class="mf">0.001</span>

  <span class="mi">4</span> <span class="n">run</span> <span class="n">specifications</span>
  <span class="p">[</span> <span class="mi">1</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span> &quot;<span class="n">single_dataset001</span>&quot; <span class="p">(</span><span class="mi">1</span> <span class="n">datasets</span><span class="p">)</span>
  <span class="p">[</span> <span class="mi">2</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span> &quot;<span class="n">single_dataset002</span>&quot; <span class="p">(</span><span class="mi">1</span> <span class="n">datasets</span><span class="p">)</span>
  <span class="p">[</span> <span class="mi">3</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span> &quot;<span class="n">single_dataset003</span>&quot; <span class="p">(</span><span class="mi">1</span> <span class="n">datasets</span><span class="p">)</span>
  <span class="p">[</span> <span class="mi">4</span><span class="p">]</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span> &quot;<span class="n">all</span>&quot; <span class="p">(</span><span class="mi">3</span> <span class="n">datasets</span><span class="p">)</span>

                          <span class="n">name</span><span class="p">:</span> <span class="s">&#39;exampleRun&#39;</span>
                       <span class="n">comment</span><span class="p">:</span> <span class="s">&#39;&#39;</span>
                      <span class="n">rootPath</span><span class="p">:</span> <span class="s">&#39;~/lorenz_example/runs&#39;</span>
                       <span class="n">version</span><span class="p">:</span> <span class="mi">3</span>
             <span class="n">datasetCollection</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="n">x1</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">DatasetCollection</span><span class="p">]</span>
                          <span class="n">runs</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="n">x4</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">Run</span><span class="p">]</span>
                        <span class="n">params</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="n">x1</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunParams</span><span class="p">]</span>
                      <span class="n">runSpecs</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="n">x1</span> <span class="n">MyExperiment</span><span class="p">.</span><span class="n">RunSpec</span><span class="p">]</span>
                       <span class="n">nParams</span><span class="p">:</span> <span class="mi">4</span>
                     <span class="n">nRunSpecs</span><span class="p">:</span> <span class="mi">4</span>
                    <span class="n">nRunsTotal</span><span class="p">:</span> <span class="mi">16</span>
                     <span class="n">nDatasets</span><span class="p">:</span> <span class="mi">3</span>
                  <span class="n">datasetNames</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="n">x1</span> <span class="n">cell</span><span class="p">}</span>
                          <span class="n">path</span><span class="p">:</span> <span class="s">&#39;~/lorenz_example/runs/exampleRun&#39;</span>
      <span class="n">pathsCommonDataForParams</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="n">x1</span> <span class="n">cell</span><span class="p">}</span>
                <span class="n">pathsForParams</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="n">x1</span> <span class="n">cell</span><span class="p">}</span>
    <span class="n">fileShellScriptTensorboard</span><span class="p">:</span> <span class="s">&#39;~/lorenz_example/runs/exampleRun/launch_tensorboard.sh&#39;</span>
               <span class="n">fileSummaryText</span><span class="p">:</span> <span class="s">&#39;~/lorenz_example/runs/exampleRun/summary.txt&#39;</span>
       <span class="n">fileShellScriptRunQueue</span><span class="p">:</span> <span class="s">&#39;~/lorenz_example/runs/exampleRun/run_lfadsqueue.py&#39;</span>
</pre></div>

<p>Then you can simply run <code class="codehilite">python run_lfadsqueue.py</code>, a script which was automatically generated to fire off all the LFADS jobs in parallel, load-balancing as many as your system can handle across available GPUs. Then wait a few hours/days&hellip;</p>
<p>As they finish, you can load and visualize the results easily in Matlab. Here we plot the inferred, single-trial firing rates of the first neuron:</p>
<div class="codehilite"><pre><span></span><span class="n">run</span> <span class="p">=</span> <span class="n">rc</span><span class="p">.</span><span class="n">runs</span><span class="p">(</span><span class="s">&#39;single_dataset001&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">pm</span> <span class="p">=</span> <span class="n">run</span><span class="p">.</span><span class="n">loadPosteriorMeans</span><span class="p">();</span>
<span class="n">rates1</span> <span class="p">=</span> <span class="nb">squeeze</span><span class="p">(</span><span class="n">pm</span><span class="p">.</span><span class="n">rates</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:));</span> <span class="c">% time x trials</span>
<span class="c">...</span>
</pre></div>

<p>The single-trial smoothed rates, colored by condition then look like:</p>
<p><img alt="Rates neuron 1" src="./images/example_rates.png" /></p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="install/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Installation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 &mdash; Daniel J. O&#39;Shea
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/djoshea" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/djoshea" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="./assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:"."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-322693-7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>